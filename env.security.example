# =============================================================================
# CA A2A Security Configuration Example
# =============================================================================
# Copy this file to .env and update with your values
# NEVER commit .env files with real secrets to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Security Features (Enable/Disable)
# -----------------------------------------------------------------------------
ENABLE_AUTHENTICATION=true
ENABLE_RATE_LIMITING=true
ENABLE_REQUEST_SIGNING=false
ENABLE_AUDIT_LOGGING=true

# -----------------------------------------------------------------------------
# JWT Configuration (JSON Web Tokens)
# -----------------------------------------------------------------------------
# IMPORTANT: Change this secret in production! Use a long random string.
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production-use-64-chars
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# -----------------------------------------------------------------------------
# Agent Authentication Credentials
# -----------------------------------------------------------------------------
# Each agent should have its own token/key for inter-agent communication
# These are used by agents when calling other agents

# Option 1: Use JWT tokens (recommended for production)
# Generate tokens using the security_tools.py script
AGENT_JWT_TOKEN=

# Option 2: Use API keys (simpler for development)
# Format: agent-name:random-key
AGENT_API_KEY=

# Example for specific agents (if you want different keys per agent):
ORCHESTRATOR_JWT_TOKEN=
ORCHESTRATOR_API_KEY=orchestrator-key-abc123xyz789

EXTRACTOR_JWT_TOKEN=
EXTRACTOR_API_KEY=extractor-key-def456uvw012

VALIDATOR_JWT_TOKEN=
VALIDATOR_API_KEY=validator-key-ghi789rst345

ARCHIVIST_JWT_TOKEN=
ARCHIVIST_API_KEY=archivist-key-jkl012mno678

# -----------------------------------------------------------------------------
# Rate Limiting Configuration
# -----------------------------------------------------------------------------
RATE_LIMIT_RPM=60        # Requests per minute per agent
RATE_LIMIT_RPH=1000      # Requests per hour per agent

# -----------------------------------------------------------------------------
# Request Signing (HMAC) - Optional
# -----------------------------------------------------------------------------
# Only enable if you need additional security beyond JWT/API keys
SIGNATURE_SECRET_KEY=your-signature-secret-change-this-in-production
SIGNATURE_MAX_AGE_SECONDS=300  # 5 minutes - prevents replay attacks

# -----------------------------------------------------------------------------
# SSL/TLS Configuration
# -----------------------------------------------------------------------------
ENABLE_SSL=false
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem
SSL_CA_CERT_PATH=/path/to/ca-cert.pem
SSL_VERIFY=true

# -----------------------------------------------------------------------------
# AWS Secrets Manager (Production)
# -----------------------------------------------------------------------------
# Instead of storing secrets in .env, use AWS Secrets Manager
# Set these to pull secrets from AWS
USE_AWS_SECRETS=false
AWS_SECRET_NAME=ca-a2a/production/secrets

# -----------------------------------------------------------------------------
# Database Configuration (for API key storage)
# -----------------------------------------------------------------------------
# If using database-backed API keys instead of in-memory
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=documents_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-db-password

# -----------------------------------------------------------------------------
# Audit Logging
# -----------------------------------------------------------------------------
# Where to send security audit logs
AUDIT_LOG_DESTINATION=cloudwatch  # cloudwatch, file, or database
AUDIT_LOG_RETENTION_DAYS=365

# -----------------------------------------------------------------------------
# Development vs Production
# -----------------------------------------------------------------------------
ENVIRONMENT=development  # development, staging, production

# =============================================================================
# Quick Setup Guide
# =============================================================================
#
# 1. DEVELOPMENT (Quick Start):
#    - Copy this file to .env
#    - Set ENABLE_AUTHENTICATION=false for testing
#    - Or use simple API keys: AGENT_API_KEY=dev-key-12345
#
# 2. STAGING:
#    - Enable authentication: ENABLE_AUTHENTICATION=true
#    - Generate JWT tokens using security_tools.py
#    - Test with realistic rate limits
#
# 3. PRODUCTION:
#    - Change ALL secrets (JWT_SECRET_KEY, etc.)
#    - Use AWS Secrets Manager: USE_AWS_SECRETS=true
#    - Enable SSL/TLS: ENABLE_SSL=true
#    - Set strict rate limits
#    - Enable audit logging
#
# =============================================================================
# Security Best Practices
# =============================================================================
#
# ✅ DO:
#    - Rotate secrets every 90 days
#    - Use strong random strings (64+ characters)
#    - Store production secrets in AWS Secrets Manager
#    - Enable audit logging in production
#    - Use HTTPS/TLS for all communication
#    - Monitor rate limit violations
#
# ❌ DON'T:
#    - Commit .env files to git (add to .gitignore)
#    - Use the same secrets in dev and prod
#    - Share secrets via email or chat
#    - Disable authentication in production
#    - Use weak or predictable secrets
#
# =============================================================================
